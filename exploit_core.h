// 作者：有问题联系～ pxx917144686

#ifndef EXPLOIT_CORE_H
#define EXPLOIT_CORE_H

int writeFilePage(const char* path);

// 漏洞链阶段
typedef enum {
    CHAIN_STAGE_INIT = 0,
    CHAIN_STAGE_COMPRESSOR,  // 压缩内存漏洞
    CHAIN_STAGE_FILE_WRITE,  // 文件写入（零页）
    CHAIN_STAGE_VM_BYPASS,   // VM映射绕过
    CHAIN_STAGE_APRR_BYPASS, // APRR权限绕过
    CHAIN_STAGE_COMPLETED    // 完成
} chain_stage_t;

// 声明漏洞链执行函数
int execute_chained_exploit(const char *target_path, 
                           void (*progress_callback)(chain_stage_t stage, const char *message, int success));

#endif
